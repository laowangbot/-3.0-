# 本地配置指南

## 问题说明

当前机器人启动失败是因为缺少有效的API凭据。从日志可以看出：

```
INFO:__main__:   Bot ID: your_bot_id
INFO:__main__:   Bot Name: your_bot_name
INFO:__main__:   API ID: 12345
INFO:__main__:   API Hash: your_api...
INFO:__main__:   Bot Token: your_bot...
```

这些都是占位符值，不是真实的凭据。

## 解决方案

### 1. 创建 .env 文件

在项目根目录创建 `.env` 文件，内容如下：

```env
# 本地开发环境配置
# 请填入您的真实凭据

# ==================== 机器人配置 ====================
# 从 https://my.telegram.org 获取
BOT_ID=your_bot_id
BOT_NAME=your_bot_name
API_ID=your_api_id
API_HASH=your_api_hash

# 从 @BotFather 获取
BOT_TOKEN=your_bot_token

# ==================== 本地端口配置 ====================
PORT=8080

# ==================== Firebase配置 ====================
# Firebase项目ID
FIREBASE_PROJECT_ID=your_firebase_project_id

# Firebase服务账号凭据（JSON格式，压缩为一行）
FIREBASE_CREDENTIALS=your_firebase_credentials_json

# ==================== 存储配置 ====================
# 设置为 true 使用本地存储，false 使用 Firebase
USE_LOCAL_STORAGE=true
```

### 2. 获取API凭据

#### 获取 API_ID 和 API_HASH
1. 访问 https://my.telegram.org
2. 使用您的手机号登录
3. 点击 "API development tools"
4. 创建新应用或使用现有应用
5. 复制 `api_id` 和 `api_hash`

#### 获取 BOT_TOKEN
1. 在Telegram中找到 @BotFather
2. 发送 `/newbot` 创建新机器人
3. 按提示设置机器人名称和用户名
4. 复制获得的 `token`

### 3. 配置说明

- **API_ID**: 必须是数字，例如：`12345678`
- **API_HASH**: 32位字符串，例如：`abcdef1234567890abcdef1234567890`
- **BOT_TOKEN**: 格式为 `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`
- **USE_LOCAL_STORAGE**: 设置为 `true` 使用本地存储，`false` 使用Firebase

### 4. 测试配置

配置完成后，运行以下命令测试：

```bash
python main.py
```

如果配置正确，应该看到类似以下的输出：

```
INFO:__main__:🔧 机器人配置:
INFO:__main__:   运行环境: 本地
INFO:__main__:   Bot ID: your_actual_bot_id
INFO:__main__:   Bot Name: your_actual_bot_name
INFO:__main__:   API ID: 12345678
INFO:__main__:   API Hash: abcdef1234567890abcdef1234567890
INFO:__main__:   Bot Token: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz
```

### 5. 常见问题

#### Q: 仍然显示占位符值
A: 确保 `.env` 文件在项目根目录，并且格式正确（没有多余的空格或引号）

#### Q: API_ID_INVALID 错误
A: 检查 API_ID 是否为数字，API_HASH 是否为32位字符串

#### Q: 机器人无法启动
A: 检查 BOT_TOKEN 格式是否正确，确保机器人已通过 @BotFather 创建

### 6. 安全提醒

- 不要将 `.env` 文件提交到Git仓库
- 不要分享您的API凭据
- 定期更换机器人token以确保安全

