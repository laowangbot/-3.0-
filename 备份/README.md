# ByBot 3.0 - Telegram搬运机器人

ByBot 3.0是一个功能强大的Telegram搬运机器人，支持评论克隆、内容过滤、反检测等多种功能。

## 主要功能

### 1. 评论搬运功能
- 支持将指定频道的消息搬运到目标频道某个消息的评论区
- 支持文本消息和媒体组消息的搬运
- 支持任务管理和状态监控

### 2. AI文本改写功能（新增）
- 在搬运过程中自动修改文本内容和标签，避免被查重
- 集成Google Gemini 2.5 Flash Lite模型，提供高质量的文本改写服务
- 支持多API密钥轮询机制，提高可用性和稳定性
- 支持多种改写强度和模式选择
- 智能额度管理，免费额度用尽时自动降级为原文搬运
- 支持预览功能，可在实际应用前预览改写效果

### 3. 内容过滤和处理
- 支持关键字过滤和替换
- 支持链接移除和处理
- 支持按钮过滤和处理
- 支持添加文本小尾巴

### 4. 反检测机制
- 支持媒体文件ID修改
- 支持内容智能改写
- 支持发送频率控制

## 安装和配置

### 环境要求
- Python 3.8+
- Telegram API ID和Hash
- Bot Token
- Google Gemini API Key（用于AI文本改写功能）

### 安装步骤
```bash
# 克隆项目
git clone <repository_url>
cd bybot3.0

# 安装依赖
pip install -r requirements.txt

# 配置环境变量
cp render_env_template.env .env
# 编辑.env文件，填入必要的配置信息
```

### 配置说明

#### 基础配置
- `API_ID` - Telegram API ID
- `API_HASH` - Telegram API Hash
- `BOT_TOKEN` - Telegram Bot Token

#### AI文本改写配置
- `GEMINI_API_KEY` - Google Gemini API密钥（主密钥）
- `GEMINI_API_KEYS` - 多个Gemini API密钥，以逗号分隔，用于轮询使用
- 在机器人中使用`/ai_settings`命令配置改写参数

## 使用方法

### 启动机器人
```bash
python lsjmain.py
```

### 评论搬运命令
```
/comment_clone <源频道> <目标频道> <目标消息ID> <消息ID1> [消息ID2] ...
```

### AI文本改写设置
```
/ai_settings - 配置AI改写参数
/ai_status - 查看AI改写状态
/ai_preview - 预览AI改写效果
```

在评论搬运时，可以通过添加参数启用AI改写：
```
/comment_clone <源频道> <目标频道> <目标消息ID> <消息ID> --ai-rewrite=on
```

### AI文本改写功能说明

#### 功能特点
1. **智能改写** - 使用Gemini 2.5 Flash Lite模型进行高质量文本改写
7. **多API密钥支持** - 支持多个API密钥轮询使用，提高稳定性和可用性
2. **多种模式** - 支持自动、强制和原文三种模式
3. **强度调节** - 提供轻微、中等、强烈三种改写强度
4. **标签处理** - 支持优化、替换、扩展和保留标签
5. **额度管理** - 智能管理免费额度，用尽时自动降级
6. **预览功能** - 可在实际使用前预览改写效果

#### 配置选项
- **开关状态**: 开启/关闭AI改写功能
- **处理模式**: 
  - 自动模式 - 有额度时改写，无额度时原文搬运
  - 强制模式 - 必须改写(额度用尽时会失败)
  - 原文模式 - 不进行AI改写
- **改写强度**: 轻微/中等/强烈
- **标签处理**: 优化/替换/扩展/保留

#### 文本格式处理
- 标签保留在第一行，内容从第二行开始
- 小尾巴内容不会被AI改写

#### 额度说明
- 每个API密钥每日免费额度：1000次调用
- 系统支持5个API密钥轮询使用，总计每日5000次调用
- 额度每日UTC+8 00:00自动重置

## 开发和贡献
欢迎提交Issue和Pull Request来改进本项目。

## 许可证
MIT License